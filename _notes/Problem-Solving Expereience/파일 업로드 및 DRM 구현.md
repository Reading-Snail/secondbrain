2023-10-04

#클린코드 #넥사크로 
상황:
엑셀 파일 업로드하여 그리드에 입력하는 부분 + DRM 복호화 기능을 담당하는 부분
의 구현을 맡게 되었다.

분석 및 해결책:
우선 넥사크로 메뉴얼을 꼼꼼히 읽어보았다.  ~~정말 발로 쓴 것 같은 메뉴얼이다... 중구난방~~
XeniExcelDataStoreageBase를 implement하여 메서드들을 구현하면 되었다. 일반적인 방식을 메뉴얼을 참고하였다. 다만, 추가적인 DRM 복호화 기능은 DRM 솔루션의 로컬에서 사용하는 프로그램의 사용방법을 참고하여 적용 할 수 있었다.
~~친절한 메뉴얼 따위는 없었다.~~

다른 분들이 놓쳤던 부분이 있다면, Xeni.properties 파일을 생성하여 구현된 클라스의 패키지 경로를 제공해주여야 된다는 부분이었다. 메뉴얼에 아주 소중하게 숨어져 있는 것을 발견하여 적용할 수 있었다.

로컬에서는 DRM이 즉각적으로 적용이 안되었는데 DRM 솔류션 자체가 외부적으로 필요한 파일들이 있어서 그랬던 부분이었다. 개발계에 배포해보니 정상 작동하였다.

추가사항:
구현을 하는 것은 어렵지 않았다. 몇번의 시행착오 끝내 쉽게 적용이 되었다. 다만 첫 코어를 만져본 경험인 만큼 더 완벽하게 코드를 작성하고 싶었다. 해서 마침 읽고 있던 클린코드를 참고하여
- 하나의 메서드는 하나의 동작만을 가져야되고, 구조적으로 아름다워야 된다.
	- 여러 기능을 맡는 복잡한 메서드를 쪼개고, 하나의 Public 메서드 하위에 다수의 Private 메서드를 두어 정리했다.
- 하나의 클래스는 하나의 명사
	- DRM 기능이 별도의 명사(의미)를 갖기 때문에 별도의 클라스로 분리하였다.
- 외부 라이브러리를 사용할 경우 Wrapper나 Adaptor로 경계 정리 할 것
	- DRM이 외부의 기능인 만큼 직접 사용하지 않고, Adaptor 패턴을 사용하여 종속성을 추가하였다.
- 오류코드는 사용하지 말 것, 로그는 문재제기를 넘어 해결책을 제시해야 된다.
	- DRM 프로그램이 구체적인 로그가 아닌 오류코드를 내뿜었다 하여 이를 관리해주는 기능도 고려해보았다.